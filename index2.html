<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Cafe Menu</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes slideUp {
      from { transform: translateY(100%); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes slideRight {
      from { transform: translateX(100%); }
      to { transform: translateX(0); }
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    @keyframes checkmark {
      0% { transform: scale(0); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    .animate-slide-up { animation: slideUp 0.3s ease-out; }
    .animate-slide-right { animation: slideRight 0.3s ease-out; }
    .animate-pulse-slow { animation: pulse 2s infinite; }
    .animate-checkmark { animation: checkmark 0.5s ease-out; }
    
    #cart-drawer > div:first-child { pointer-events: auto; }
    #cart-drawer > div:last-child { pointer-events: auto; position: relative; z-index: 10; }
  </style>
</head>
<body class="bg-orange-50">

<!-- Header -->
<header class="sticky top-0 z-40 bg-white shadow-sm px-4 py-3 flex justify-between items-center">
  <div class="flex items-center gap-2">
    <div class="bg-orange-500 p-2 rounded-full text-white">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><line x1="6" x2="6" y1="2" y2="4"/><line x1="10" x2="10" y1="2" y2="4"/><line x1="14" x2="14" y1="2" y2="4"/></svg>
    </div>
    <h1 class="text-xl font-bold text-orange-800">My Cafe Menu</h1>
  </div>
  
  <button onclick="toggleCart()" class="relative p-2 hover:bg-gray-100 rounded-full transition-colors">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
    <span id="cart-badge" class="hidden absolute top-0 right-0 bg-red-500 text-white text-xs font-bold w-5 h-5 flex items-center justify-center rounded-full">0</span>
  </button>
</header>

<!-- Main Content - Menu Page -->
<main id="menu-page" class="container mx-auto max-w-2xl px-4 py-6 pb-24">
  <div class="mb-6 text-center">
    <h2 class="text-2xl font-bold text-gray-800 mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</h2>
    <p class="text-gray-500">‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô ‡∏≠‡∏£‡πà‡∏≠‡∏¢ ‡∏ñ‡∏π‡∏Å‡πÉ‡∏à ‡∏™‡∏±‡πà‡∏á‡πÄ‡∏•‡∏¢!</p>
  </div>
  <div id="menu-grid" class="grid grid-cols-2 gap-4"></div>
</main>

<!-- Checkout Page - Delivery Selection -->
<div id="checkout-page" class="hidden container mx-auto max-w-2xl px-4 py-6 pb-24">
  <div class="mb-6">
    <button onclick="goBackToMenu()" class="flex items-center gap-2 text-gray-600 hover:text-orange-600 mb-4">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
      ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π
    </button>
    <h2 class="text-2xl font-bold text-gray-800 mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
    <p class="text-gray-500">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô</p>
  </div>

  <!-- Order Summary -->
  <div class="bg-white rounded-xl p-4 shadow-sm mb-6">
    <h3 class="font-bold text-gray-800 mb-3 flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z"/><line x1="6" x2="18" y1="17" y2="17"/></svg>
      ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
    </h3>
    <div id="checkout-items" class="space-y-2 text-sm"></div>
    <div class="border-t mt-3 pt-3 flex justify-between items-center">
      <span class="font-bold text-gray-700">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
      <span id="checkout-total" class="text-xl font-bold text-orange-600">0.-</span>
    </div>
  </div>

  <!-- Delivery Options -->
  <div class="space-y-4">
    <!-- Option 1: Building A -->
    <div class="bg-white rounded-xl p-4 shadow-sm border-2 border-transparent hover:border-orange-200 transition-all cursor-pointer" onclick="selectDeliveryOption('buildingA')">
      <label class="flex items-start gap-3 cursor-pointer">
        <input type="radio" name="delivery" value="buildingA" class="mt-1 w-5 h-5 text-orange-600">
        <div class="flex-1">
          <div class="flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="16" height="20" x="4" y="2" rx="2" ry="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M12 6h.01"/><path d="M12 10h.01"/><path d="M12 14h.01"/><path d="M16 10h.01"/><path d="M16 14h.01"/><path d="M8 10h.01"/><path d="M8 14h.01"/></svg>
            <span class="font-bold text-gray-800">‡∏ï‡∏∂‡∏Å A - ‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏´‡πâ‡∏≠‡∏á</span>
          </div>
          <p class="text-sm text-gray-500 mt-1">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡∏ô‡∏≥‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
          <div id="buildingA-details" class="hidden mt-3 space-y-3">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏±‡πâ‡∏ô</label>
              <select id="buildingA-floor" class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500" onclick="event.stopPropagation()">
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô --</option>
                <option value="1">‡∏ä‡∏±‡πâ‡∏ô 1</option>
                <option value="2">‡∏ä‡∏±‡πâ‡∏ô 2</option>
                <option value="3">‡∏ä‡∏±‡πâ‡∏ô 3</option>
                <option value="4">‡∏ä‡∏±‡πâ‡∏ô 4</option>
                <option value="5">‡∏ä‡∏±‡πâ‡∏ô 5</option>
                <option value="6">‡∏ä‡∏±‡πâ‡∏ô 6</option>
                <option value="7">‡∏ä‡∏±‡πâ‡∏ô 7</option>
                <option value="8">‡∏ä‡∏±‡πâ‡∏ô 8</option>
                <option value="9">‡∏ä‡∏±‡πâ‡∏ô 9</option>
                <option value="10">‡∏ä‡∏±‡πâ‡∏ô 10</option>
                <option value="11">‡∏ä‡∏±‡πâ‡∏ô 11</option>
                <option value="12">‡∏ä‡∏±‡πâ‡∏ô 12</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏•‡∏Ç‡∏´‡πâ‡∏≠‡∏á</label>
              <input type="text" id="buildingA-room" placeholder="‡πÄ‡∏ä‡πà‡∏ô 101, 205" class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500" onclick="event.stopPropagation()">
            </div>
          </div>
        </div>
      </label>
    </div>

    <!-- Option 2: Building B -->
    <div class="bg-white rounded-xl p-4 shadow-sm border-2 border-transparent hover:border-orange-200 transition-all cursor-pointer" onclick="selectDeliveryOption('buildingB')">
      <label class="flex items-start gap-3 cursor-pointer">
        <input type="radio" name="delivery" value="buildingB" class="mt-1 w-5 h-5 text-orange-600">
        <div class="flex-1">
          <div class="flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="16" height="20" x="4" y="2" rx="2" ry="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M12 6h.01"/><path d="M12 10h.01"/><path d="M12 14h.01"/><path d="M16 10h.01"/><path d="M16 14h.01"/><path d="M8 10h.01"/><path d="M8 14h.01"/></svg>
            <span class="font-bold text-gray-800">‡∏ï‡∏∂‡∏Å B - ‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏´‡πâ‡∏≠‡∏á</span>
          </div>
          <p class="text-sm text-gray-500 mt-1">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡∏ô‡∏≥‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
          <div id="buildingB-details" class="hidden mt-3 space-y-3">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏±‡πâ‡∏ô</label>
              <select id="buildingB-floor" class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500" onclick="event.stopPropagation()">
                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô --</option>
                <option value="1">‡∏ä‡∏±‡πâ‡∏ô 1</option>
                <option value="2">‡∏ä‡∏±‡πâ‡∏ô 2</option>
                <option value="3">‡∏ä‡∏±‡πâ‡∏ô 3</option>
                <option value="4">‡∏ä‡∏±‡πâ‡∏ô 4</option>
                <option value="5">‡∏ä‡∏±‡πâ‡∏ô 5</option>
                <option value="6">‡∏ä‡∏±‡πâ‡∏ô 6</option>
                <option value="7">‡∏ä‡∏±‡πâ‡∏ô 7</option>
                <option value="8">‡∏ä‡∏±‡πâ‡∏ô 8</option>
                <option value="9">‡∏ä‡∏±‡πâ‡∏ô 9</option>
                <option value="10">‡∏ä‡∏±‡πâ‡∏ô 10</option>
                <option value="11">‡∏ä‡∏±‡πâ‡∏ô 11</option>
                <option value="12">‡∏ä‡∏±‡πâ‡∏ô 12</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏•‡∏Ç‡∏´‡πâ‡∏≠‡∏á</label>
              <input type="text" id="buildingB-room" placeholder="‡πÄ‡∏ä‡πà‡∏ô 101, 205" class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-orange-500 focus:border-orange-500" onclick="event.stopPropagation()">
            </div>
          </div>
        </div>
      </label>
    </div>

    <!-- Option 3: Pickup -->
    <div class="bg-white rounded-xl p-4 shadow-sm border-2 border-transparent hover:border-orange-200 transition-all cursor-pointer" onclick="selectDeliveryOption('pickup')">
      <label class="flex items-start gap-3 cursor-pointer">
        <input type="radio" name="delivery" value="pickup" class="mt-1 w-5 h-5 text-orange-600">
        <div class="flex-1">
          <div class="flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9Z"/><path d="m3 9 2.45-4.9A2 2 0 0 1 7.24 3h9.52a2 2 0 0 1 1.8 1.1L21 9"/><path d="M12 3v6"/></svg>
            <span class="font-bold text-gray-800">‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô</span>
          </div>
          <p class="text-sm text-gray-500 mt-1">‡∏•‡∏á‡∏°‡∏≤‡∏£‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô</p>
        </div>
      </label>
    </div>
  </div>

  <!-- Continue Button -->
  <button id="continue-to-payment" onclick="goToPayment()" class="w-full mt-6 bg-orange-600 text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:bg-orange-700 active:scale-95 transition-all disabled:bg-gray-300 disabled:cursor-not-allowed" disabled>
    ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
  </button>
</div>

<!-- Payment Page - QR Code -->
<div id="payment-page" class="hidden container mx-auto max-w-2xl px-4 py-6 pb-24">
  <div class="text-center mb-6">
    <h2 class="text-2xl font-bold text-gray-800 mb-2">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h2>
    <p class="text-gray-500">‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
  </div>

  <!-- Timer Warning -->
  <div id="timer-warning" class="bg-red-50 border border-red-200 rounded-xl p-4 mb-6">
    <div class="flex items-center justify-center gap-2 text-red-600">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
      <span class="font-bold">QR Code ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô</span>
      <span id="countdown" class="text-2xl font-bold animate-pulse-slow">05:00</span>
    </div>
  </div>

  <!-- QR Code Display -->
  <div class="bg-white rounded-xl p-6 shadow-lg mb-6">
    <div class="flex flex-col items-center">
      <!-- QR Code Placeholder - Replace with actual PromptPay QR -->
      <div id="qr-container" class="bg-gray-100 p-4 rounded-xl mb-4">
        <div class="w-48 h-48 bg-white flex items-center justify-center border-2 border-dashed border-gray-300 rounded-lg">
          <!-- This would be replaced with actual QR code image -->
          <div class="text-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="mx-auto text-gray-400 mb-2"><rect width="5" height="5" x="3" y="3" rx="1"/><rect width="5" height="5" x="16" y="3" rx="1"/><rect width="5" height="5" x="3" y="16" rx="1"/><path d="M21 16h-3a2 2 0 0 0-2 2v3"/><path d="M21 21v.01"/><path d="M12 7v3a2 2 0 0 1-2 2H7"/><path d="M3 12h.01"/><path d="M12 3h.01"/><path d="M12 16v.01"/><path d="M16 12h1"/><path d="M21 12v.01"/><path d="M12 21v-1"/></svg>
            <p class="text-xs text-gray-400">QR PromptPay</p>
          </div>
        </div>
      </div>

      <!-- Payment Info -->
      <div class="text-center mb-4">
        <p class="text-sm text-gray-500">‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞</p>
        <p id="payment-amount" class="text-3xl font-bold text-orange-600">0.-</p>
      </div>

      <!-- Bank Info -->
      <div class="bg-gray-50 rounded-lg p-3 w-full text-center">
        <p class="text-sm text-gray-600">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏¢‡πå: <span class="font-bold">0XX-XXX-XXXX</span></p>
        <p class="text-sm text-gray-600">‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: <span class="font-bold">My Cafe</span></p>
      </div>
    </div>
  </div>

  <!-- Upload Slip Section -->
  <div class="bg-white rounded-xl p-6 shadow-sm">
    <h3 class="font-bold text-gray-800 mb-4 flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>
      ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
    </h3>
    
    <!-- Steps -->
    <div class="space-y-3 mb-4">
      <div class="flex items-start gap-3">
        <div class="w-6 h-6 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0 text-orange-600 font-bold text-sm">1</div>
        <p class="text-sm text-gray-600">‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</p>
      </div>
      <div class="flex items-start gap-3">
        <div class="w-6 h-6 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0 text-orange-600 font-bold text-sm">2</div>
        <p class="text-sm text-gray-600">Screenshot ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏•‡∏¥‡∏õ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</p>
      </div>
      <div class="flex items-start gap-3">
        <div class="w-6 h-6 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0 text-green-600 font-bold text-sm">3</div>
        <p class="text-sm text-gray-600">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î <strong>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</strong></p>
      </div>
    </div>

    <!-- Upload Area -->
    <p class="text-sm font-medium text-gray-700 mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ:</p>
    <div id="upload-area" class="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-orange-400 transition-colors cursor-pointer" onclick="document.getElementById('slip-input').click()">
      <input type="file" id="slip-input" accept="image/*" class="hidden" onchange="handleSlipUpload(event)">
      <div id="upload-placeholder">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="mx-auto text-gray-400 mb-2"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>
        <p class="text-gray-500">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ</p>
        <p class="text-xs text-gray-400 mt-1">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö JPG, PNG</p>
      </div>
      <div id="upload-preview" class="hidden">
        <img id="slip-preview" class="max-h-40 mx-auto rounded-lg mb-2">
        <p class="text-green-600 font-medium">‚úì ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏•‡∏¥‡∏õ‡πÅ‡∏•‡πâ‡∏ß</p>
        <p class="text-xs text-gray-400 mt-1">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ</p>
      </div>
    </div>

    <!-- Confirm Button -->
    <button id="confirm-payment" onclick="confirmPayment()" class="w-full mt-4 bg-green-500 text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:bg-green-600 active:scale-95 transition-all disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2" disabled>
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
      ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
    </button>
    
    <p class="text-xs text-center text-gray-400 mt-3">
      ‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏•‡∏¥‡∏õ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    </p>
  </div>

  <!-- QR Expired Modal -->
  <div id="qr-expired-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center">
    <div class="absolute inset-0 bg-black/50"></div>
    <div class="bg-white rounded-2xl p-6 mx-4 max-w-sm w-full relative z-10 text-center animate-slide-up">
      <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-red-500"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>
      </div>
      <h3 class="text-xl font-bold text-gray-800 mb-2">QR Code ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</h3>
      <p class="text-gray-500 mb-6">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡πÉ‡∏´‡∏°‡πà</p>
      <button onclick="regenerateQR()" class="w-full bg-orange-600 text-white py-3 rounded-xl font-bold hover:bg-orange-700 transition-colors">
        ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡πÉ‡∏´‡∏°‡πà
      </button>
    </div>
  </div>
</div>

<!-- Thank You Page -->
<div id="thankyou-page" class="hidden container mx-auto max-w-2xl px-4 py-6 pb-24">
  <div class="text-center py-12">
    <!-- Success Animation -->
    <div class="w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6 animate-checkmark">
      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="text-green-500"><polyline points="20 6 9 17 4 12"/></svg>
    </div>

    <h2 class="text-2xl font-bold text-gray-800 mb-2">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠! üéâ</h2>
    <p class="text-gray-500 mb-8">‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏•‡πâ‡∏ß</p>

    <!-- Order Status Card -->
    <div class="bg-white rounded-xl p-6 shadow-lg mb-6 text-left">
      <div class="flex items-center gap-3 mb-4">
        <div class="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-orange-600"><path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><line x1="6" x2="6" y1="2" y2="4"/><line x1="10" x2="10" y1="2" y2="4"/><line x1="14" x2="14" y1="2" y2="4"/></svg>
        </div>
        <div>
          <p class="font-bold text-gray-800">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</p>
          <p class="text-sm text-gray-500">‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡∏ô‡∏∞‡∏Ñ‡∏∞...</p>
        </div>
      </div>

      <!-- Delivery Info -->
      <div id="delivery-info" class="bg-gray-50 rounded-lg p-4 mb-4">
        <p class="text-sm text-gray-600 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</p>
        <p id="delivery-location" class="font-bold text-gray-800"></p>
      </div>

      <!-- Order Items -->
      <div class="border-t pt-4">
        <p class="text-sm text-gray-600 mb-2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</p>
        <div id="thankyou-items" class="space-y-2 text-sm"></div>
        <div class="border-t mt-3 pt-3 flex justify-between">
          <span class="font-bold">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</span>
          <span id="thankyou-total" class="font-bold text-orange-600"></span>
        </div>
      </div>
    </div>

    <!-- Status Messages -->
    <div class="bg-blue-50 rounded-xl p-4 mb-6">
      <div class="flex items-start gap-3">
        <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        </div>
        <div class="text-left">
          <p id="status-message" class="font-medium text-blue-800">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì</p>
          <p class="text-sm text-blue-600 mt-1">‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 5-10 ‡∏ô‡∏≤‡∏ó‡∏µ</p>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <button onclick="resetOrder()" class="w-full bg-orange-600 text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:bg-orange-700 active:scale-95 transition-all">
      ‡∏™‡∏±‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å
    </button>
  </div>
</div>

<!-- Product Modal -->
<div id="modal" class="hidden fixed inset-0 z-50 flex items-end sm:items-center justify-center">
  <div class="absolute inset-0 bg-black/40" onclick="closeModal()"></div>
  <div class="bg-white w-full max-w-md rounded-t-2xl sm:rounded-2xl p-6 shadow-xl relative animate-slide-up">
    <div class="flex justify-between items-start mb-4">
      <div>
        <h3 id="modal-name" class="text-xl font-bold text-gray-900 pr-4"></h3>
        <p id="modal-price" class="text-orange-600 font-bold text-lg"></p>
      </div>
      <button onclick="closeModal()" class="p-1 bg-gray-100 rounded-full hover:bg-gray-200">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
      </button>
    </div>

    <div id="sweetness-section" class="mb-6">
      <h4 class="font-semibold text-gray-700 mb-3 text-sm">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏≤‡∏ô</h4>
      <div class="space-y-2" id="sweetness-options"></div>
    </div>

    <div class="flex items-center justify-between mb-6 bg-gray-50 p-3 rounded-lg">
      <span class="font-semibold text-gray-700">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</span>
      <div class="flex items-center gap-4">
        <button onclick="changeQuantity(-1)" class="w-8 h-8 flex items-center justify-center rounded-full bg-white border shadow-sm text-gray-600 active:scale-95 transition-transform">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/></svg>
        </button>
        <span id="quantity" class="font-bold text-lg w-6 text-center">1</span>
        <button onclick="changeQuantity(1)" class="w-8 h-8 flex items-center justify-center rounded-full bg-orange-500 text-white shadow-sm active:scale-95 transition-transform">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>
        </button>
      </div>
    </div>

    <button onclick="addToCart()" class="w-full bg-orange-600 text-white py-3 rounded-xl font-bold text-lg shadow-lg hover:bg-orange-700 active:scale-95 transition-all">
      ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ <span id="modal-total">0</span>.-
    </button>
  </div>
</div>

<!-- Cart Drawer -->
<div id="cart-drawer" class="hidden fixed inset-0 z-50 flex justify-end">
  <div class="absolute inset-0 bg-black/20" onclick="toggleCart()"></div>
  <div class="w-full max-w-md bg-white h-full shadow-2xl flex flex-col animate-slide-right">
    <div class="p-4 border-b flex justify-between items-center bg-orange-50">
      <h2 class="text-lg font-bold flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
        ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
      </h2>
      <button onclick="toggleCart()" class="p-2 hover:bg-orange-100 rounded-full">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
      </button>
    </div>

    <div id="cart-items" class="flex-1 overflow-y-auto p-4"></div>

    <div id="cart-footer" class="hidden p-4 border-t bg-gray-50">
      <div class="flex justify-between items-center mb-4">
        <span class="text-gray-600">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
        <span id="total-price" class="text-2xl font-bold text-orange-600">0.-</span>
      </div>
      
      <button onclick="proceedToCheckout()" class="w-full bg-orange-600 text-white py-3 rounded-xl font-bold shadow-lg hover:bg-orange-700 transition-colors flex items-center justify-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
        ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
      </button>
    </div>
  </div>
</div>

<!-- Floating Cart Button -->
<div id="floating-cart" class="hidden fixed bottom-6 right-6 z-40">
  <button onclick="toggleCart()" class="bg-orange-600 text-white p-4 rounded-full shadow-lg hover:bg-orange-700 transition-transform hover:scale-105 flex items-center gap-2">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
    <span id="floating-badge" class="font-bold">0</span>
  </button>
</div>

<script>
// === CONFIG ===
const LINE_OA_ID = '@570uqhbl';
const QR_TIMEOUT = 5 * 60; // 5 minutes in seconds
const GOOGLE_SCRIPT_URL = 'YOUR_GOOGLE_SCRIPT_URL_HERE'; // ‚¨ÖÔ∏è ‡πÉ‡∏™‡πà URL ‡∏à‡∏≤‡∏Å Google Apps Script

// === MENU DATA ===
const MENU_ITEMS = [
  { id: 1, name: '‡πÄ‡∏ô‡∏™‡∏Å‡∏≤‡πÅ‡∏ü (Nescafe)', price: 29, category: 'Coffee' },
  { id: 2, name: '‡∏Å‡∏≤‡πÅ‡∏ü‡πÇ‡∏ö‡∏£‡∏≤‡∏ì (Thai Coffee Milk)', price: 29, category: 'Coffee' },
  { id: 3, name: '‡πÇ‡∏≠‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á (Thai Coffee Iced)', price: 29, category: 'Coffee' },
  { id: 4, name: '‡∏ä‡∏≤‡∏ô‡∏°‡πÑ‡∏ï‡πâ‡∏´‡∏ß‡∏±‡∏ô (Taiwan Milk Tea)', price: 29, category: 'Tea' },
  { id: 5, name: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢ (Thai Tea)', price: 29, category: 'Tea' },
  { id: 6, name: '‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (Green Tea)', price: 29, category: 'Tea' },
  { id: 7, name: '‡πÇ‡∏Å‡πÇ‡∏Å‡πâ (Cocoa)', price: 29, category: 'Milk' },
  { id: 8, name: '‡πÇ‡∏≠‡∏ß‡∏±‡∏•‡∏ï‡∏¥‡∏ô (Ovaltine)', price: 29, category: 'Milk' },
  { id: 9, name: '‡∏ô‡∏°‡∏ä‡∏°‡∏û‡∏π (Pink Milk)', price: 29, category: 'Milk' },
  { id: 10, name: '‡∏ô‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (Green Milk)', price: 29, category: 'Milk' },
  { id: 11, name: '‡∏ô‡∏°‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å (Taro Milk)', price: 29, category: 'Milk' },
  { id: 12, name: '‡∏ô‡∏°‡∏™‡∏î (Fresh Milk)', price: 29, category: 'Milk' },
  { id: 13, name: '‡∏ä‡∏≤‡∏°‡∏∞‡∏ô‡∏≤‡∏ß (Lemon Thai Tea)', price: 29, category: 'Tea' },
  { id: 14, name: '‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏°‡∏∞‡∏ô‡∏≤‡∏ß (Lemon Green Tea)', price: 29, category: 'Tea' },
  { id: 15, name: '‡πÅ‡∏î‡∏á‡∏°‡∏∞‡∏ô‡∏≤‡∏ß (Lemon Red Syrup)', price: 29, category: 'Refreshment' },
  { id: 16, name: '‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏°‡∏∞‡∏ô‡∏≤‡∏ß (Lemon Green Syrup)', price: 29, category: 'Refreshment' },
  { id: 17, name: '‡πÇ‡∏Ñ‡πâ‡∏Å (Coca-Cola)', price: 25, category: 'Soft Drink' },
  { id: 18, name: '‡πÅ‡∏ü‡∏ô‡∏ï‡πâ‡∏≤ ‡∏™‡πâ‡∏° (Fanta Orange)', price: 25, category: 'Soft Drink' },
  { id: 19, name: '‡πÅ‡∏ü‡∏ô‡∏ï‡πâ‡∏≤ ‡πÅ‡∏î‡∏á (Fanta Red)', price: 25, category: 'Soft Drink' },
  { id: 20, name: '‡∏™‡πÑ‡∏õ‡∏£‡πå‡∏ó (Sprite)', price: 25, category: 'Soft Drink' },
  { id: 21, name: '‡∏ô‡πâ‡∏≥‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (Green Soda)', price: 25, category: 'Soft Drink' },
];

const SWEETNESS_LEVELS = [
  { label: '‡∏´‡∏ß‡∏≤‡∏ô‡∏°‡∏≤‡∏Å 100%', value: '100%' },
  { label: '‡∏´‡∏ß‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ 70%', value: '70%' },
  { label: '‡∏´‡∏ß‡∏≤‡∏ô‡∏ô‡πâ‡∏≠‡∏¢ 50%', value: '50%' },
  { label: '‡πÑ‡∏°‡πà‡∏´‡∏ß‡∏≤‡∏ô 0%', value: '0%' },
];

// === STATE ===
let cart = [];
let selectedItem = null;
let currentQuantity = 1;
let currentSweetness = '70%';
let selectedDelivery = null;
let countdownInterval = null;
let remainingTime = QR_TIMEOUT;
let slipUploaded = false;

// === RENDER MENU ===
function renderMenu() {
  const grid = document.getElementById('menu-grid');
  grid.innerHTML = MENU_ITEMS.map(item => `
    <div onclick="openModal(${item.id})" class="bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow overflow-hidden cursor-pointer border border-gray-100 flex flex-col">
      <div class="aspect-square bg-gray-200 w-full flex items-center justify-center text-gray-400 relative">
        <div class="text-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto mb-1 opacity-50"><path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><line x1="6" x2="6" y1="2" y2="4"/><line x1="10" x2="10" y1="2" y2="4"/><line x1="14" x2="14" y1="2" y2="4"/></svg>
          <span class="text-xs">‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
        </div>
        ${item.category === 'Soft Drink' ? '<span class="absolute top-2 right-2 bg-blue-500 text-white text-[10px] px-2 py-0.5 rounded-full font-bold">‡πÄ‡∏¢‡πá‡∏ô‡∏ã‡πà‡∏≤</span>' : ''}
      </div>
      <div class="p-3 flex flex-col flex-grow">
        <h3 class="font-semibold text-gray-800 line-clamp-2 mb-1 leading-snug text-sm">${item.name}</h3>
        <div class="mt-auto flex justify-between items-center pt-2">
          <span class="text-orange-600 font-bold text-lg">${item.price}.-</span>
          <button class="bg-orange-100 text-orange-600 p-1.5 rounded-lg hover:bg-orange-200 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>
          </button>
        </div>
      </div>
    </div>
  `).join('');
}

// === MODAL FUNCTIONS ===
function openModal(itemId) {
  selectedItem = MENU_ITEMS.find(item => item.id === itemId);
  currentQuantity = 1;
  currentSweetness = '70%';
  
  document.getElementById('modal-name').textContent = selectedItem.name;
  document.getElementById('modal-price').textContent = `${selectedItem.price} ‡∏ö‡∏≤‡∏ó`;
  document.getElementById('quantity').textContent = currentQuantity;
  document.getElementById('modal-total').textContent = selectedItem.price;
  
  const sweetnessSection = document.getElementById('sweetness-section');
  if (selectedItem.category === 'Soft Drink') {
    sweetnessSection.style.display = 'none';
  } else {
    sweetnessSection.style.display = 'block';
    renderSweetnessOptions();
  }
  
  document.getElementById('modal').classList.remove('hidden');
}

function closeModal() {
  document.getElementById('modal').classList.add('hidden');
}

function renderSweetnessOptions() {
  const container = document.getElementById('sweetness-options');
  container.innerHTML = SWEETNESS_LEVELS.map(level => `
    <label class="flex items-center justify-between p-3 rounded-lg border cursor-pointer transition-all ${currentSweetness === level.value ? 'border-orange-500 bg-orange-50 text-orange-700' : 'border-gray-200 hover:bg-gray-50'}">
      <span class="text-sm font-medium">${level.label}</span>
      <input type="radio" name="sweetness" value="${level.value}" ${currentSweetness === level.value ? 'checked' : ''} onchange="currentSweetness = this.value; renderSweetnessOptions()" class="w-4 h-4 text-orange-600">
    </label>
  `).join('');
}

function changeQuantity(change) {
  currentQuantity = Math.max(1, currentQuantity + change);
  document.getElementById('quantity').textContent = currentQuantity;
  document.getElementById('modal-total').textContent = selectedItem.price * currentQuantity;
}

function addToCart() {
  const newItem = {
    ...selectedItem,
    cartId: Date.now(),
    sweetness: selectedItem.category !== 'Soft Drink' ? currentSweetness : null,
    quantity: currentQuantity,
  };
  
  cart.push(newItem);
  updateCart();
  closeModal();
}

// === CART FUNCTIONS ===
function updateCart() {
  const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
  const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
  
  const badge = document.getElementById('cart-badge');
  const floatingBadge = document.getElementById('floating-badge');
  if (totalItems > 0) {
    badge.classList.remove('hidden');
    badge.textContent = totalItems;
    floatingBadge.textContent = totalItems;
    document.getElementById('floating-cart').classList.remove('hidden');
  } else {
    badge.classList.add('hidden');
    document.getElementById('floating-cart').classList.add('hidden');
  }
  
  const container = document.getElementById('cart-items');
  if (cart.length === 0) {
    container.innerHTML = `
      <div class="flex flex-col items-center justify-center h-full text-gray-400">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 opacity-50"><path d="M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z"/><line x1="6" x2="18" y1="17" y2="17"/></svg>
        <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</p>
      </div>
    `;
    document.getElementById('cart-footer').classList.add('hidden');
  } else {
    container.innerHTML = cart.map(item => `
      <div class="flex gap-3 border-b border-gray-100 pb-3 mb-3">
        <div class="w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-400"><path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><line x1="6" x2="6" y1="2" y2="4"/><line x1="10" x2="10" y1="2" y2="4"/><line x1="14" x2="14" y1="2" y2="4"/></svg>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start">
            <h4 class="font-bold text-gray-800 text-sm">${item.name}</h4>
            <button onclick="removeFromCart(${item.cartId})" class="text-gray-400 hover:text-red-500">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>
            </button>
          </div>
          ${item.sweetness ? `<p class="text-xs text-gray-500 mt-1">‡∏´‡∏ß‡∏≤‡∏ô: ${item.sweetness}</p>` : ''}
          <div class="flex justify-between items-center mt-2">
            <span class="text-xs bg-gray-100 px-2 py-1 rounded text-gray-600">x${item.quantity}</span>
            <span class="font-bold text-orange-600">${item.price * item.quantity}.-</span>
          </div>
        </div>
      </div>
    `).join('');
    
    document.getElementById('total-price').textContent = `${totalPrice}.-`;
    document.getElementById('cart-footer').classList.remove('hidden');
  }
}

function removeFromCart(cartId) {
  cart = cart.filter(item => item.cartId !== cartId);
  updateCart();
}

function toggleCart() {
  const drawer = document.getElementById('cart-drawer');
  drawer.classList.toggle('hidden');
}

// === PAGE NAVIGATION ===
function showPage(pageName) {
  document.getElementById('menu-page').classList.add('hidden');
  document.getElementById('checkout-page').classList.add('hidden');
  document.getElementById('payment-page').classList.add('hidden');
  document.getElementById('thankyou-page').classList.add('hidden');
  
  document.getElementById(`${pageName}-page`).classList.remove('hidden');
  window.scrollTo(0, 0);
}

function proceedToCheckout() {
  if (cart.length === 0) return;
  
  toggleCart();
  renderCheckoutSummary();
  showPage('checkout');
}

function goBackToMenu() {
  showPage('menu');
}

// === CHECKOUT FUNCTIONS ===
function renderCheckoutSummary() {
  const container = document.getElementById('checkout-items');
  const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
  
  container.innerHTML = cart.map(item => `
    <div class="flex justify-between items-center">
      <span class="text-gray-700">${item.name} ${item.sweetness ? `(${item.sweetness})` : ''} x${item.quantity}</span>
      <span class="font-medium">${item.price * item.quantity}.-</span>
    </div>
  `).join('');
  
  document.getElementById('checkout-total').textContent = `${totalPrice}.-`;
}

function selectDeliveryOption(option) {
  selectedDelivery = option;
  
  // Update radio buttons
  document.querySelectorAll('input[name="delivery"]').forEach(radio => {
    radio.checked = radio.value === option;
  });
  
  // Update border styles
  document.querySelectorAll('[onclick^="selectDeliveryOption"]').forEach(el => {
    el.classList.remove('border-orange-500', 'bg-orange-50');
    el.classList.add('border-transparent');
  });
  event.currentTarget.classList.remove('border-transparent');
  event.currentTarget.classList.add('border-orange-500', 'bg-orange-50');
  
  // Show/hide detail forms
  document.getElementById('buildingA-details').classList.add('hidden');
  document.getElementById('buildingB-details').classList.add('hidden');
  
  if (option === 'buildingA') {
    document.getElementById('buildingA-details').classList.remove('hidden');
  } else if (option === 'buildingB') {
    document.getElementById('buildingB-details').classList.remove('hidden');
  }
  
  validateDeliveryForm();
}

function validateDeliveryForm() {
  const btn = document.getElementById('continue-to-payment');
  let isValid = false;
  
  if (selectedDelivery === 'pickup') {
    isValid = true;
  } else if (selectedDelivery === 'buildingA') {
    const floor = document.getElementById('buildingA-floor').value;
    const room = document.getElementById('buildingA-room').value;
    isValid = floor && room;
  } else if (selectedDelivery === 'buildingB') {
    const floor = document.getElementById('buildingB-floor').value;
    const room = document.getElementById('buildingB-room').value;
    isValid = floor && room;
  }
  
  btn.disabled = !isValid;
}

// Add event listeners for form validation
document.getElementById('buildingA-floor').addEventListener('change', validateDeliveryForm);
document.getElementById('buildingA-room').addEventListener('input', validateDeliveryForm);
document.getElementById('buildingB-floor').addEventListener('change', validateDeliveryForm);
document.getElementById('buildingB-room').addEventListener('input', validateDeliveryForm);

// === PAYMENT PAGE ===
function goToPayment() {
  if (!selectedDelivery) return;
  
  const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
  document.getElementById('payment-amount').textContent = `${totalPrice}.-`;
  
  // Reset payment state
  slipUploaded = false;
  document.getElementById('confirm-payment').disabled = true;
  document.getElementById('upload-placeholder').classList.remove('hidden');
  document.getElementById('upload-preview').classList.add('hidden');
  
  // Start countdown
  startCountdown();
  
  showPage('payment');
}

function startCountdown() {
  remainingTime = QR_TIMEOUT;
  updateCountdownDisplay();
  
  if (countdownInterval) {
    clearInterval(countdownInterval);
  }
  
  countdownInterval = setInterval(() => {
    remainingTime--;
    updateCountdownDisplay();
    
    if (remainingTime <= 0) {
      clearInterval(countdownInterval);
      showQRExpiredModal();
    }
  }, 1000);
}

function updateCountdownDisplay() {
  const minutes = Math.floor(remainingTime / 60);
  const seconds = remainingTime % 60;
  const display = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
  document.getElementById('countdown').textContent = display;
  
  // Change color when low
  const timerWarning = document.getElementById('timer-warning');
  if (remainingTime <= 60) {
    timerWarning.classList.remove('bg-red-50', 'border-red-200');
    timerWarning.classList.add('bg-red-100', 'border-red-300');
    document.getElementById('countdown').classList.add('text-red-700');
  } else {
    timerWarning.classList.remove('bg-red-100', 'border-red-300');
    timerWarning.classList.add('bg-red-50', 'border-red-200');
    document.getElementById('countdown').classList.remove('text-red-700');
  }
}

function showQRExpiredModal() {
  document.getElementById('qr-expired-modal').classList.remove('hidden');
}

function regenerateQR() {
  document.getElementById('qr-expired-modal').classList.add('hidden');
  startCountdown();
}

// === SLIP UPLOAD ===
function handleSlipUpload(event) {
  const file = event.target.files[0];
  if (!file) return;
  
  const reader = new FileReader();
  reader.onload = function(e) {
    document.getElementById('slip-preview').src = e.target.result;
    document.getElementById('upload-placeholder').classList.add('hidden');
    document.getElementById('upload-preview').classList.remove('hidden');
    slipUploaded = true;
    document.getElementById('confirm-payment').disabled = false;
  };
  reader.readAsDataURL(file);
}

// === CONFIRM PAYMENT ===
async function confirmPayment() {
  if (!slipUploaded) return;
  
  // Stop countdown
  if (countdownInterval) {
    clearInterval(countdownInterval);
  }
  
  // Show loading
  const btn = document.getElementById('confirm-payment');
  const originalText = btn.innerHTML;
  btn.disabled = true;
  btn.innerHTML = `
    <svg class="animate-spin h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
    </svg>
    ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå...
  `;
  
  // Send order via LINE Notify
  const success = await sendOrderToLineNotify();
  
  if (success) {
    prepareThankYouPage();
    showPage('thankyou');
  } else {
    btn.disabled = false;
    btn.innerHTML = originalText;
    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
  }
}

function prepareThankYouPage() {
  let locationText = '';
  if (selectedDelivery === 'pickup') {
    locationText = 'üìç ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô';
    document.getElementById('status-message').textContent = '‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì';
  } else if (selectedDelivery === 'buildingA') {
    const floor = document.getElementById('buildingA-floor').value;
    const room = document.getElementById('buildingA-room').value;
    locationText = `üè¢ ‡∏ï‡∏∂‡∏Å A ‡∏ä‡∏±‡πâ‡∏ô ${floor} ‡∏´‡πâ‡∏≠‡∏á ${room}`;
    document.getElementById('status-message').textContent = '‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏° ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏ô‡∏≥‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì';
  } else if (selectedDelivery === 'buildingB') {
    const floor = document.getElementById('buildingB-floor').value;
    const room = document.getElementById('buildingB-room').value;
    locationText = `üè¢ ‡∏ï‡∏∂‡∏Å B ‡∏ä‡∏±‡πâ‡∏ô ${floor} ‡∏´‡πâ‡∏≠‡∏á ${room}`;
    document.getElementById('status-message').textContent = '‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏° ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡∏ô‡∏≥‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì';
  }
  document.getElementById('delivery-location').textContent = locationText;
  
  const container = document.getElementById('thankyou-items');
  container.innerHTML = cart.map(item => `
    <div class="flex justify-between">
      <span class="text-gray-600">${item.name} ${item.sweetness ? `(${item.sweetness})` : ''} x${item.quantity}</span>
      <span class="font-medium">${item.price * item.quantity}.-</span>
    </div>
  `).join('');
  
  const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
  document.getElementById('thankyou-total').textContent = `${totalPrice}.-`;
}

async function sendOrderToLineNotify() {
  // Build message
  let message = "\n‚òï ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà!\n";
  message += "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n";
  
  if (selectedDelivery === 'pickup') {
    message += "üìç ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà: ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô\n\n";
  } else if (selectedDelivery === 'buildingA') {
    const floor = document.getElementById('buildingA-floor').value;
    const room = document.getElementById('buildingA-room').value;
    message += `üè¢ ‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á: ‡∏ï‡∏∂‡∏Å A ‡∏ä‡∏±‡πâ‡∏ô ${floor} ‡∏´‡πâ‡∏≠‡∏á ${room}\n\n`;
  } else if (selectedDelivery === 'buildingB') {
    const floor = document.getElementById('buildingB-floor').value;
    const room = document.getElementById('buildingB-room').value;
    message += `üè¢ ‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á: ‡∏ï‡∏∂‡∏Å B ‡∏ä‡∏±‡πâ‡∏ô ${floor} ‡∏´‡πâ‡∏≠‡∏á ${room}\n\n`;
  }
  
  message += "üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:\n";
  cart.forEach((item, index) => {
    message += `${index + 1}. ${item.name}`;
    if (item.sweetness) {
      message += ` (${item.sweetness})`;
    }
    message += ` x${item.quantity} = ${item.price * item.quantity}.-\n`;
  });
  
  const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
  message += `\nüí∞ ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${totalPrice} ‡∏ö‡∏≤‡∏ó\n`;
  message += "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n";
  message += "üìé ‡∏™‡∏•‡∏¥‡∏õ‡πÅ‡∏ô‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‚¨áÔ∏è";

  // Get slip as base64
  const slipInput = document.getElementById('slip-input');
  const slipFile = slipInput.files[0];
  
  let imageBase64 = '';
  if (slipFile) {
    imageBase64 = await fileToBase64(slipFile);
  }

  try {
    const response = await fetch(GOOGLE_SCRIPT_URL, {
      method: 'POST',
      mode: 'no-cors',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        message: message,
        imageBase64: imageBase64
      })
    });
    
    return true;
  } catch (error) {
    console.error('Error sending to LINE Notify:', error);
    return false;
  }
}

function fileToBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => {
      const base64 = reader.result.split(',')[1];
      resolve(base64);
    };
    reader.onerror = error => reject(error);
  });
}

// === RESET ORDER ===
function resetOrder() {
  cart = [];
  selectedDelivery = null;
  slipUploaded = false;
  
  // Reset form fields
  document.querySelectorAll('input[name="delivery"]').forEach(radio => radio.checked = false);
  document.getElementById('buildingA-floor').value = '';
  document.getElementById('buildingA-room').value = '';
  document.getElementById('buildingB-floor').value = '';
  document.getElementById('buildingB-room').value = '';
  document.getElementById('buildingA-details').classList.add('hidden');
  document.getElementById('buildingB-details').classList.add('hidden');
  
  // Reset delivery option borders
  document.querySelectorAll('[onclick^="selectDeliveryOption"]').forEach(el => {
    el.classList.remove('border-orange-500', 'bg-orange-50');
    el.classList.add('border-transparent');
  });
  
  updateCart();
  showPage('menu');
}

// === INIT ===
renderMenu();
</script>

</body>
</html>
